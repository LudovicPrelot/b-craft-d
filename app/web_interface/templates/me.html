{% extends "base.html" %}
{% block title %}Mon profil{% endblock %}

{% block content %}
<h1>Mon profil</h1>
<pre id="me"></pre>
{% endblock %}

{% block scripts %}
<script>
(async function(){
  const token = localStorage.getItem('access_token');
  if(!token){ window.location.href = "/login"; return; }
  const r = await fetch('/me', { headers: {'Authorization':'Bearer '+token} });
  if(!r.ok){ alert('Erreur'); return; }
  const j = await r.json();
  document.getElementById('me').textContent = JSON.stringify(j, null, 2);
})();
</script>
{% endblock %}

{% extends "base.html" %}
{% block title %}Inscription{% endblock %}

{% block content %}
<h1>Créer un compte</h1>
<form id="registerForm">
    <input name="firstname" placeholder="Prénom" required><br>
    <input name="lastname" placeholder="Nom" required><br>
    <input name="mail" placeholder="Email" required><br>
    <input name="login" placeholder="Login" required><br>
    <input name="password" type="password" placeholder="Mot de passe" required><br>
    <input name="profession" placeholder="Profession (ex: miner)"><br>
    <button>Créer</button>
</form>
<script>
document.getElementById('registerForm').onsubmit = async (e) => {
    e.preventDefault();
    const f = new FormData(e.target);
    const body = {
        firstname: f.get('firstname'), lastname: f.get('lastname'),
        mail: f.get('mail'), login: f.get('login'), password: f.get('password'),
        profession: f.get('profession'), subclasses: []
    };
    const res = await fetch('/auth/register', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(body) });
    if(!res.ok){ alert('Erreur'); return; }
    alert('Compte créé');
    window.location.href = "/login";
};
</script>
{% endblock %}
